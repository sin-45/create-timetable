# create-timetable

## 概要
本システムは，時間割データからpdf形式の時間割表を自動作成するPythonプログラムである．
また，時間割データがない場合でもランダムに時間割を作成することもできる．

## 特徴
* **自動レイアウト調整:** 科目名や教員名が長い場合、枠に収まるようにフォントサイズを自動で縮小します。
* **教員名の併記:** 「科目名\n教員名」のデータに対応し、教員名のみ文字サイズや色を変更して見やすく出力します。
* **文字コード自動判定:** UTF-8およびShift-JIS（Excel由来のタブ区切りデータ）の両方に自動対応しています。
* **ランダム生成機能:** 既存のデータがない場合でも、ダミーの時間割をランダムに生成してテスト可能です。

## 動作環境・要件
* Python 3.11.9 （※ `csv`, `pathlib`, `os`, `sys`, `random` などの標準ライブラリを使用）
* 外部ライブラリは `requirements.txt` に記載。

## ディレクトリ構成

```text
project_root/
├── main.py                  # システムの実行用メインスクリプト
    ├──src
        ├── existing_create_table.py # 既存のCSV/TSVデータを読み込むモジュール
        ├── random_create_table.py   # ランダムな時間割データを生成するモジュール
        ├── pdf_generator.py         # reportlabを使ってPDFを描画するモジュール
├── requirements.txt         # 必要なライブラリの一覧
└── other_file/
    └── table.csv            # 読み込み用の時間割データ（タブ区切り推奨）
```

## インストール手順
### 1. 本システムのディレクトリをダウンロード、またはcloneして任意の場所に配置する。
### 2. ターミナル（またはコマンドプロンプト）でシステムのディレクトリに移動し、以下のコマンドを実行して必要なライブラリ（reportlab）をインストールする。
```
pip install -r requirements.txt
```

## 使い方
### 1. データの準備
  既存のデータを使用する場合は，other_file/に時間割データを配置する．
    - 1つのマスに「科目名」と「教員名」を両方表示したい場合は、データ内で改行を行うこと。
### 2. プログラムの実行
　ターミナルで以下のコマンドを実行する．        
```text
pip install -r requirements.txt
python main.py 
```
### 3. 出力の確認
　実行後、プロンプトで「既存のデータを使いますか？(y/n)」と聞かれるため、キーボードで入力してEnterを押す。
　処理が正常に完了すると、同じディレクトリ内に時間割のPDFファイル（例: timetable.pdf）が生成される。
